#!/usr/bin/php
<?php

#
# Update or delete an entry in config.php.
# Called by kiwi's config.sh
#
if ($argc < 3)
  {
    print "Example Usage:\n". __FILE__." path/to/config.php overwritewebroot /owncloud\n";
    # nothing to do
    return;
  }


# $cfg = $argv[1]; # '/srv/www/htdocs/owncloud/config/config.php';
if (!is_file($argv[1]))
  {
    # do not create the file, if missing. 
    # Wrong permissions are deadly for owncloud.
    return;
  }

include "$argv[1]";

if ($argc > 3)
  {
    # TODO: add a syntax for arrays, then we can obsolete
    # root/bin/update_trusted_domain called by config.sh
    $CONFIG[$argv[2]] = $argv[3];
  }
else
  {
    # exactly two parameter given -- means delete.
    unset($CONFIG[$argv[2]]);
  }

$text = var_export($CONFIG, true);
file_put_contents($argv[1], "<?php\n\$CONFIG = $text;\n");
?>
