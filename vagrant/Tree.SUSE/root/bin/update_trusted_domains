#!/usr/bin/php
<?php

#
# update the trusted_domain to the given parameter.
# (or delete the trusted_domain entry if no parameter given)
#

$cfg = '/srv/www/htdocs/owncloud/config/config.php';
if (!is_file($cfg))
  {
    # do not create the file, if missing. 
    # Wrong permissions are deadly for owncloud.
    return;
  }

include "$cfg";

if ($argc > 1)
  {
    $CONFIG["trusted_domains"] = [ $argv[1] ];
  }
else
  {
    unset($CONFIG["trusted_domains"]);
  }

$text = var_export($CONFIG, true);
file_put_contents($cfg, "<?php\n\$CONFIG = $text;\n");
?>
